<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

		<title>The Code4Lib Journal &#8211; Citation Needed: Adding Citations to CONTENTdm Records</title>

		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="generator" content="WordPress 6.8.1" /> <!-- leave this for stats -->
    <link rel="shortcut icon" href="../wp-content/themes/c4lj-theme/images/favicon.ico" />
		<link rel="stylesheet" href="../wp-content/themes/c4lj-theme/style.css" type="text/css" media="screen, print" />
		<!--[if lte IE 7]>
		<link rel="stylesheet" href="https://journal.code4lib.org/wp-content/themes/c4lj-theme/fix-ie7.css" type="text/css" media="screen" />
		<![endif]-->
		<!--[if lte IE 6]>
		<link rel="stylesheet" href="https://journal.code4lib.org/wp-content/themes/c4lj-theme/fix-ie6.css" type="text/css" media="screen" />
		<![endif]-->
		<link rel="stylesheet" href="../wp-content/themes/c4lj-theme/print.css" type="text/css" media="print" />
		<link rel="alternate" type="application/rss+xml" title="The Code4Lib Journal Syndication Feed" href="http://feeds.feedburner.com/c4lj" />
		<link rel="pingback" href="https://journal.code4lib.org/xmlrpc.php" />

<!-- Google Scholar Stuff -->
	<meta name="citation_title" content="Citation Needed: Adding Citations to CONTENTdm Records">
 <meta name="citation_author" content="Jenn Randles &amp; Andrew Bullen">
<meta name="citation_publication_date" content="2022/05/09">
	<meta name="citation_journal_title" content="Code4Lib Journal">
		<meta name="citation_issue" content="53">
<!-- end  Google Scholar Stuff -->

<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="The Code4Lib Journal &raquo; Citation Needed: Adding Citations to CONTENTdm Records Comments Feed" href="16289/feed" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/journal.code4lib.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../wp-includes/css/dist/block-library/style.min.css%3Fver=6.8.1.css' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<style id='akismet-widget-style-inline-css' type='text/css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link rel="https://api.w.org/" href="../wp-json/index.html" /><link rel="alternate" title="JSON" type="application/json" href="../wp-json/wp/v2/posts/16289" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://journal.code4lib.org/xmlrpc.php?rsd" />
<link rel="canonical" href="../index.html%3Fp=16289.html" />
<link rel='shortlink' href='../index.html%3Fp=16289.html' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fjournal.code4lib.org%252Farticles%252F16289" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fjournal.code4lib.org%252Farticles%252F16289&amp;format=xml" />
<style>
@media all and (max-width : 768px) {
.syntaxhighlighter a, .syntaxhighlighter div, .syntaxhighlighter code, .syntaxhighlighter table, .syntaxhighlighter table td, .syntaxhighlighter table tr, .syntaxhighlighter table tbody, .syntaxhighlighter table thead, .syntaxhighlighter table caption, .syntaxhighlighter textarea
{
	font-size: 0.95em !important;
}
}
</style>
	</head>
	<body>
		<div id="page">
			<div id="header">
				<div id="headerbackground">
					<h1><a href="../index.html"><img src="../wp-content/themes/c4lj-theme/images/logo.png" alt="The Code4Lib Journal" /></a></h1>
				</div>
				<div id="about">
					<ul>
						<li class="page_item page-item-5"><a href="../index.html%3Fp=5.html">Mission</a></li>
<li class="page_item page-item-6"><a href="../editorial-committee/index.html">Editorial Committee</a></li>
<li class="page_item page-item-8"><a href="../process/index.html">Process and Structure</a></li>
						<li><a href="http://code4lib.org/">Code4Lib</a></li>
					</ul>
				</div>
				<div class="mobile-search">
					<form method="get" id="searchform" action="../index.html">
						<div>
							<input type="text" value="" aria-labelledby="searchsubmit" name="s" id="s" />
							<input type="submit" value="Search" id="searchsubmit" />
						</div>
					</form>
				</div>
			</div>

			<div id="content">
								<div class="article" id="post-16289">
					<p id="issueDesignation"><a href="../issues/issues/issue53.html">Issue 53, 2022-05-09</a></p>
					<h1 class="articletitle">Citation Needed: Adding Citations to CONTENTdm Records</h1>
					<div class="abstract">
						<p>The Tennessee State Library and Archives and the Illinois State Library identified a need to add citation information to individual image records in OCLC’s CONTENTdm (https://www.oclc.org/en/contentdm.html).  Experience with digital archives at both institutions showed that citation information was one of the most requested features. Unfortunately, CONTENTdm does not natively display citation information about image records; to add this functionality, custom JavaScript had to be written that would interact with the underlying React environment and parse out or retrieve the appropriate metadata to dynamically build record citations. Detailed code and a description of methods for building two different models of citation generators are presented.</p>
					</div>
					<div class="entry">
						<p>by Jenn Randles &amp; Andrew Bullen</p>
<h2>Introduction</h2>
<p>The Tennessee State Library and Archives and the Illinois State Library identified a need to add citation information to individual image records in OCLC’s CONTENTdm (<a href="https://www.oclc.org/en/contentdm.html"><b>https://www.oclc.org/en/contentdm.html</b></a>). Experience with digital archives at both institutions showed that citation information was one of the most requested features. Unfortunately, CONTENTdm does not natively display citation information about image records; to add this functionality, custom JavaScript had to be written that would interact with the underlying React environment and parse out or retrieve the appropriate metadata to dynamically build record citations.</p>
<p>Jenn Randles, then Digital Materials Librarian at the Tennessee State Library &amp; Archives, and Andrew Bullen, Information Technology Coordinator for the Illinois State Library, both expressed a willingness to work on this problem via the CONTENTdm User Community Forum site. Shane Huddleston, Senior Developer at CONTENTdm, volunteered to assist Randles and Bullen. This article delves into each approach, demonstrates the code of each solution, and displays the end results.</p>
<h2>The Problem</h2>
<p>Both institutions’ statewide repositories for digital collections contain a large number of digital objects from a wide variety of contributors. The Tennessee Virtual Archive [TeVA] (<a href="https://teva.contentdm.oclc.org/"><b>https://teva.contentdm.oclc.org/</b></a>) comprises 67 collections. The Illinois Digital Archives [IDA] (<a href="https://www.idaillinois.org/"><b>https://www.idaillinois.org/</b></a>) consists of more than 200 collections.</p>
<p>Metadata in TeVA is uniform across the varied collections since metadata is submitted by one organization. IDA collections, however, have widely varied metadata schemas since they are contributed by many institutions. Using the IIIF API works well when metadata fields are consistent across collections but isn’t applicable otherwise. Therefore, the contributors had to develop their own approaches. Despite working on two solutions, Randles and Bullen worked together to develop JavaScript code that would work for each environment. They consulted as needed with Shane Huddleston for expert guidance on programming JavaScript in CONTENTdm’s React environment.</p>
<p>Since there had to be two approaches to the same problem, Randles and Bullen have each written and documented their separate, successful code solutions.</p>
<h2>Solution 1. Jenn Randles, Tennessee Virtual Archive.</h2>
<p><em>tl;dr. Because TeVA’s metadata is uniform, Jenn parsed the IIIF JSON manifest for the record to dynamically build the citation.</em></p>
<p>Link to script: <a href="https://teva.contentdm.oclc.org/customizations/global/pages/js/tsla-cite-global.js">https://teva.contentdm.oclc.org/customizations/global/pages/js/tsla-cite-global.js</a></p>
<p>For TeVA, the most pressing reason to provide citations alongside a digital collection item is simple: users asked for it. Over the five years I held this position, one of the most requested features was citation on each item. To start my work, I reviewed other institutions to see how they accomplished this task. Other organizations added citations manually, but with over 30,000 records already in the system, we did not have the staff to undertake such a project.</p>
<p>We do have the AddThis Widget (<a href="https://www.addthis.com/">https://www.addthis.com/</a>) on every item page on TeVA, but it only includes one citation manager: CiteThis. Since many of our users among the general public do not use that service or any citation manager at all, I wanted to go with another option. My end goal was not to provide academic-style citations but give users like bloggers and genealogists a quick way to record sources without having to make many decisions.</p>
<p>I made the decision to use CONTENTdm’s International Image Interoperability Framework (IIIF) API to dynamically build record citations. CONTENTdm enabled the IIIF API (<a href="https://help.oclc.org/Metadata_Services/CONTENTdm/Advanced_website_customization/API_Reference/IIIF_API_reference">https://help.oclc.org/Metadata_Services/CONTENTdm/Advanced_website_customization/API_Reference/IIIF_API_reference</a>) on all hosted sites several years ago. The IIIF framework provides a way to access digital assets and their metadata from a variety of platforms like Mirador and Leaflet. Knowing that the metadata I needed existed in the IIIF item manifest that was already a part of CONTENTdm, this seemed like the perfect opportunity to try it out.</p>
<p>Since all TeVA’s metadata is in fields with the same labels across collections, I knew I could use the API to return the same data from each item and print it to the screen in a specific order.</p>
<h3>Data Needed</h3>
<p>First, I determined what data I needed from the API:</p>
<ul>
<li aria-level="1">CONTENTdm collection alias</li>
<li aria-level="1">CONTENTdm item ID</li>
<li aria-level="1">Title</li>
<li aria-level="1">Creator</li>
<li aria-level="1">Date of item</li>
<li aria-level="1">Collection Name</li>
<li aria-level="1">Storage location (box and folder in the collection)</li>
<li aria-level="1">Digital Object ID (essential for locating digital surrogates)</li>
<li aria-level="1">Owning institution (we house both Tennessee State Library and Archives and Tennessee Historical Society collections)</li>
<li aria-level="1">Repository (TeVA)</li>
</ul>
<h3>Getting Collection <em>alias</em> and <em>item ID</em></h3>
<p>The first step is to find two variables: the CONTENTdm collection alias and item ID. Both can be grabbed from the URL of the item’s page. The format of URLs in CONTENTdm is https://teva.contentdm.oclc.org/digital/collection/[collection alias]/id/[ID], such as <a href="https://teva.contentdm.oclc.org/digital/collection/highlander/id/1032"><b><i>https://teva.contentdm.oclc.org/digital/collection/highlander/id/1032</i></b></a>.</p>
<p>The CONTENTdm item ID is different than our Digital Object ID. We need both, since the itemID is part of the IIIF manifest URL. To get these I split the window pathname, called those parts by index number, and assigned them to variables. I had to include the global var at the front, since an upgrade to the backend broke my previous code. I need to declare this at the beginning; otherwise, it throws an error and no citation shows on the page.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
var global = global || window;
pathArray = window.location.pathname.split(&quot;/&quot;);
collAlias = pathArray&#x5B;3];
itemID = pathArray&#x5B;5];
</pre>
<h3>Mapping Manifest Fields</h3>
<p>I now have the necessary information to build a manifest link. I can map CONTENTdm fields based on API labels in the manifest, such as in <a href="https://teva.contentdm.oclc.org/iiif/2/highlander:1032/manifest.json"><b>https://teva.contentdm.oclc.org/iiif/2/highlander:1032/manifest.json</b></a>.</p>
<p>An IIIF JSON manifest is an array of key-value pairs that can appear in a different order based on what metadata exists in the record. Simply calling these by index will not work due to this variable order; however, since our labels are consistent across collections, I can use them instead. The script calls data by label later on, but first I will put these fields in order of the final citation, so they show up in the order I want.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
const mappings = {
  Title: &quot;itemTitle&quot;,
  order: 0,
  Creator: &quot;itemCreator&quot;,
  order: 1,
  Date: &quot;itemDate&quot;,
  order: 2,
  &quot;Collection Name&quot;: &quot;itemCollection&quot;,
  order: 3,
  &quot;Storage Location&quot;: &quot;itemStorage&quot;,
  order: 4,
  &quot;ID#&quot;: &quot;itemID&quot;,
  order: 5,
  &quot;Owning Institution&quot;: &quot;itemOwning&quot;,
  order: 6,
  Repository: &quot;itemRepository&quot;,
  order: 7,
};

</pre>
<h3>Check For Parent Record ID</h3>
<p>I now need to check and see if the script was not returning manifests due to items being part of a compound object. Compound objects are multi-page items stored in a hierarchy on CONTENTdm. In TeVA, we always have citation fields on the item level, but often not on the page level. Additionally, each page of an item and the main item-level record itself have different CONTENTdm IDs. We need to check whether a record has a parent and return that parent record information to locate the manifest. Otherwise, the script will not return anything since it cannot find the manifest.</p>
<p>I got this code from Shane Huddleston at OCLC- thanks!</p>
<pre class="brush: jscript; title: ; notranslate" title="">
function getParent(item, collection) {
  return (
    fetch(
      `/digital/bl/dmwebservices/index.php?q=GetParent/${collection}/${item}/json`
    )
      .then((response) =&gt; response.json())
      // make GetParent API call and return as JSON
      .then((json) =&gt; {
        let parent = false;
        // parse JSON for 'parent' value; -1 indicates parent ID is the same as item ID
        if (json.parent === -1) {
          parent = item;
        } else {
          parent = json.parent;
        }
        return parent;
      })
      .then((parent) =&gt; {
        // once parent is known, check if IIIF Pres manifest exists
        return fetch(`/iiif/info/${collection}/${parent}/manifest.json`)
          .then((response) =&gt; {
            if (response.status != 200) {
              console.log(&quot;No IIIF manifest exists for this record.&quot;);
              parent = false;
              // if no manifest exists, return is 'false' so that IIIF button is not inserted
              return parent;
            } else {
              // check if manifest is for single-item PDF
              return fetch(
                `/digital/api/collections/${collection}/items/${parent}/false`
              )
                .then((response) =&gt; response.json())
                .then((json) =&gt; {
                  if (json.filename.split(&quot;.&quot;).pop() === &quot;pdf&quot;) {
                    // if item format is pdf return is false so that IIIF button is not inserted
                    console.log(&quot;pdf?&quot;, json.filename.split(&quot;.&quot;).pop());
                    parent = false;
                    return parent;
                  } else {
                    return parent;
                  }
                })
                .catch((error) =&gt;
                  console.log(&quot;Item API request failed.&quot;, error)
                );
            }
          })
          .catch((error) =&gt; {
            console.log(&quot;Manifest request failed.&quot;, error);
            parent = false;
            return parent;
          });
      })
      .catch(function (error) {
        console.log(&quot;GetParent request failed.&quot;, error);
        parent = false;
        return parent;
      })
  );
}


</pre>
<h3>API Call, Assigning Data Via Labels</h3>
<p>The next step is an API call, pointing to the manifest using collAlias and itemID, then mapping label/value pairs to the variables in the const mappings.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
async function buildMetadataObject(collAlias, itemID) {
  let response = await fetch(
    &quot;https://teva.contentdm.oclc.org/iiif/info/&quot; +
      global.collAlias +
      &quot;/&quot; +
      global.itemID +
      &quot;/manifest.json&quot;
  );
  let data = await response.json();
  return data.metadata.reduce(
    (acc, { label, value }) =&gt; ({ ...acc, &#x5B;mappings&#x5B;label]]: value }),
    {}
  );
}

</pre>
<h3>Creating the Citation</h3>
<p>The final section takes the pieces specified and puts them in order using the following steps:</p>
<ul>
<li aria-level="1">Grab today’s date for date accessed.</li>
<li aria-level="1">Create reference URL from collAlias and itemID.</li>
<li aria-level="1">Add itemTitle to blacklist because we need to add quotes to it in the builder.</li>
<li aria-level="1">Reduce to ignore undefined values, since not every field has data in it. It was printing “undefined” before this addition.</li>
<li aria-level="1">Create const itemCite using mappings order and join those. I decided to go with a local citation format so we don’t need to update often and it won’t clutter the page. The format works for the public who just needs something quick and not a specific format. This gets us a citation that works for many users, without much upkeep on our side or accounting for multiple formats.</li>
<li aria-level="1">Add link to our citation info that has a guide to citations for digitized archival materials, then put the entire thing in a div at the end of the metadata section after a line. I grabbed this location idea from my co-author Andrew Bullen- thanks!</li>
</ul>
<pre class="brush: jscript; title: ; notranslate" title="">
function insertCitation(data) {
  var tTitle = data.itemTitle;
  var url =
    &quot;https://teva.contentdm.oclc.org/digital/collection/&quot; +
    global.collAlias +
    &quot;/id/&quot; +
    global.itemID;
  var dateToday = new Date().toISOString().slice(0, 10);
  const fieldBlackList = &#x5B;&quot;itemTitle&quot;];
  const itemCite = `&lt;hr /&gt;&lt;strong&gt;Citation:&lt;/strong&gt; \n &quot;${
    data.itemTitle
  },&quot; ${Object.values(mappings)
    .reduce((acc, cur) =&gt; {
      if (fieldBlackList.includes(cur)) return acc;
      const value = data&#x5B;cur];
      return value ? &#x5B;...acc, value] : acc;
    }, &#x5B;])
    .join(
      &quot;, &quot;
    )}, ${url}, accessed ${dateToday}. &lt;br&gt;Note: This citation is auto-generated and may be incomplete. Check your preferred style guide or the &lt;a href=&quot;https://teva.contentdm.oclc.org/customizations/global/pages/about.html&quot;&gt;About TeVA page&lt;/a&gt; for more information.`;
  const citationContainer = document.createElement(&quot;div&quot;);
  citationContainer.id = &quot;citation&quot;;
  citationContainer.innerHTML = itemCite;
  if (tTitle) {
    document
      .querySelector(&quot;.ItemView-itemViewContainer&quot;)
      .appendChild(citationContainer);
  }
}


</pre>
<h3>Printing to Page</h3>
<p>This section prints the citation after the page loads or on the page update.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
(async () =&gt; {
  document.addEventListener(&quot;cdm-item-page:ready&quot;, async function (e) {
    const citationData = await buildMetadataObject();
    insertCitation(citationData);
  });
  document.addEventListener(&quot;cdm-item-page:update&quot;, async function (e) {
    document.getElementById(&quot;citation&quot;).remove();
    const citationData = await buildMetadataObject();
    insertCitation(citationData);
  });
})();

</pre>
<p><b>Link to the whole script:</b> <a href="https://teva.contentdm.oclc.org/customizations/global/pages/js/tsla-cite-global.js"><b>https://teva.contentdm.oclc.org/customizations/global/pages/js/tsla-cite-global.js</b></a></p>
<h3>The End Result</h3>
<p class="caption"><a href="../media/issue53/randles/figure1-large.png"><img decoding="async" src="../media/issue53/randles/figure1-large.png" alt="Metadata from a TeVA collection item" /></a><br />
<strong>Figure 1.</strong> Metadata from a TeVA collection item. IIIF JSON manifest for this item: <a href="https://teva.contentdm.oclc.org/iiif/2/highlander:1032/manifest.json">https://teva.contentdm.oclc.org/iiif/2/highlander:1032/manifest.json</a></p>
<p class="caption"><a href="../media/issue53/randles/figure2-large.png"><img decoding="async" src="../media/issue53/randles/figure2-large.png" alt="Dynamically-created citation for the item in Fig. 1" /></a><br />
<strong>Figure 2.</strong> Dynamically-created citation for the item in Fig. 1</p>
<h3>Solution 1: Conclusion</h3>
<p>If I were to expand this, I would work on a multi-format citation generator so users could choose what they needed. I would still display the local citation on the page but would have other options available with a few clicks.</p>
<h2>Solution 2. Andrew Bullen, Illinois Digital Archives</h2>
<p><i>tl;dr. Because IDA’s metadata varies widely across the collections, Andrew created a Collection of Collections that contains a field listing the collection’s field names. He then used CONTENTdm’s APIs to retrieve the data from the record itself, which could then be used to assemble the proper record citation.</i></p>
<p><b>Link to the whole script: </b><a href="https://www.idaillinois.org/customizations/global/js/citation.js"><b>https://www.idaillinois.org/customizations/global/js/citation.js</b></a></p>
<h3>A Collection of Collections</h3>
<p>We have found a useful addition to our CONTENTdm instance is a management collection, which contains administrative information about the other collections. Our so-called <i>collection of collections</i> can be viewed at <a href="http://www.idaillinois.org/digital/collection/p16614coll32/search/"><b>https://www.idaillinois.org/digital/collection/p16614coll32/search/</b></a>. Among the information contained about each collection is the <b><i>Creator</i></b> of the collection, which contains the agency and its URL of the contributor; <b><i>controlNumber</i></b>, which is useful in connecting the agency and collection to an agency administration system; and, since we have a number of local history collections, <b><i>city</i></b> and <b><i>county</i></b>, which will someday be used to map the collections and geolocate them.</p>
<p>We added a field, <b><i>citationField</i></b>, that contains the field names of the elements that make up image citations in most formats. We chose what we determined were the most popular: MLA (version 8), Chicago/Turabian, APA (version 6), and IEEE. The seven field names are held in a string separated by the pipe symbol (|).</p>
<h3>Field Names and Nicknames in CONTENTdm</h3>
<p>Since our contributing institutions contribute and create their own metadata records, we cannot count on uniform field names or even the existence of all of the fields that make up a citation. A problem that we encountered from the first was that CONTENTdm stores fields using a nickname, which can vary from collection to collection even if the label used is the same. For instance, one institution might have a field of <b><i>Creator</i></b>, with a nickname of <i>creato</i>, and another might have the same field name stored as <i>creator</i>.</p>
<p>I created a simple PHP program to display the field names and their nicknames of a given collection. It is invoked from a shell prompt as <b><i>php findCitation.php &lt;CONTENTdm collection alias&gt;</i></b>.</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
        $alias = $argv&#x5B;1];

        $fieldData = file_get_contents(&quot;https://server16614.contentdm.oclc.org/dmwebservices/index.php?q=dmGetCollectionFieldInfo/$alias/xml&quot;);

// Of course, change the line above to the URL for your server instance…

        $fieldData = simplexml_load_string($fieldData);

        foreach ($fieldData-&gt;xpath('//field') as $record) {
                $resultA&#x5B;] = array(
                        'nick' =&gt; (string) $record-&gt;nick,
                        'name' =&gt; (string) $record-&gt;name
                );
        }
        $resultACount = count($resultA) - 1;
        for ($iA=0;$iA&lt;=$resultACount;$iA++) {
                $nick = $resultA&#x5B;$iA]&#x5B;&quot;nick&quot;];
                $name = $resultA&#x5B;$iA]&#x5B;&quot;name&quot;];
                echo &quot;$name: $nick\n&quot;;
        }

?&gt;

</pre>
<p>In order for our method to work, we need to assemble author, title, date, type, collection name, institution name, and description from each collection. For many collections, we can assemble reasonable surrogates; for some, fields are not available and so are simply marked as “n.a.” or “n.d.”.</p>
<p>The information is then added to the citationField field in the record, as the nicknamed aliases for Creator | Title | Original Date | Type | Collection Name | Publisher | Description.</p>
<p class="caption"><a href="../media/issue53/randles/figure3-large.png"><img decoding="async" src="../media/issue53/randles/figure3-large.png" alt="Screen shot of a collection of collections record" /></a><br />
<strong>Figure 3.</strong> Screen shot of a collection of collections record</p>
<h3>CONTENTdm’s APIs and the JavaScript Program</h3>
<p>Two listeners initiate the program. They check, respectively, for a brand new page and for a next or a previous page change.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
  document.addEventListener('cdm-item-page:ready', async function (e) {
		executeScript(e.detail.collectionId,e.detail.itemId);
  });

  document.addEventListener('cdm-item-page:update', async function (e) {
		document.getElementById('citation').remove();
		executeScript(e.detail.collectionId,e.detail.itemId);
  });
</pre>
<p><strong><em>executeScript </em></strong>begins the program action itself. We need to access the information contained in our collection of collections in two steps. In the first step, we need to find out what the seven-element <em>citationField</em> value is as well as retrieve the alias of the collection.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
function executeScript(collectionName,recordNumber) {
		var cdmStr = &quot;/digital/bl/dmwebservices/index.php?q=dmQuery/p16614coll32/identi^&quot; + collectionName + &quot;^all^and/citati!identi/citati/1/1/0/0/0/0/json&quot;;
		const request = new XMLHttpRequest();
		request.open('GET', cdmStr);
		request.responseType = 'json';
		request.send();			
		request.onload = function() {
			var obj = request.response;
			generateDiv(obj, recordNumber); 			
		}
	}

</pre>
<p><strong><em>executeScript </em></strong>takes two values, the CONTENTdm alias of the collection and the record number of the current record. It then makes an API call, <strong><em>dmQuery </em></strong>(<a href="https://help.oclc.org/Metadata_Services/CONTENTdm/Advanced_website_customization/API_Reference/CONTENTdm_API/CONTENTdm_Server_API_Functions_-_dmwebservices">https://help.oclc.org/Metadata_Services/CONTENTdm/Advanced_website_customization/API_Reference/CONTENTdm_API/CONTENTdm_Server_API_Functions_-_dmwebservices</a>), querying the collection of collections (p16614coll32) to return the seven-element citation string and the collection alias. It then calls the next function, <strong><em>generateDiv</em></strong>, to actually build the citation entries.</p>
<p><strong><em>generateDiv</em></strong> is called with two values, the JSON results of the first dmQuery API call and the record number of the current record. It then takes the citation field and splits it into its elemental parts. The resulting variables contain the nicknames of the relevant fields in the main record.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
var apiRecord = obj&#x5B;'records'];
var citation = apiRecord&#x5B;0]&#x5B;'citati'];
var collectionID = apiRecord&#x5B;0]&#x5B;'identi'];	

if (citation) {										
var recordData = citation.split(&quot;|&quot;);
	var creatorLabel = recordData&#x5B;0];
	var titleLabel = recordData&#x5B;1];
	var dateLabel = recordData&#x5B;2];
	var typeLabel = recordData&#x5B;3];
	var collectionLabel = recordData&#x5B;4];
	var institutionLabel = recordData&#x5B;5];
	var descriptionLabel = recordData&#x5B;6];	
</pre>
<p><strong><em>generateDiv</em></strong> assembles a new CONTENTdm API call, <strong><em>dmGetItemInfo</em></strong>, to access the data of the record in question.</p>
<pre class="brush: jscript; title: ; notranslate" title="">

var mainRecordStr = &quot;/digital/bl/dmwebservices/index.php?q=dmGetItemInfo/&quot; + collectionID + &quot;/&quot; + recordNumber + &quot;/json&quot;;	
</pre>
<p>It creates a container, a &lt;div&gt;, so that the newly assembled citation data has a home:</p>
<pre class="brush: jscript; title: ; notranslate" title="">		
const citationContainer = document.createElement('div');
citationContainer.id = 'citation';

</pre>
<p>…and actually makes the async query, resulting in a JSON record being returned:</p>
<pre class="brush: jscript; title: ; notranslate" title="">
var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
if (this.readyState == 4 &amp;&amp; this.status == 200) {
		var myObj = JSON.parse(this.responseText);
</pre>
<p>Since we know the nicknames for the fields in question, we can now load variables with proper values:</p>
<pre class="brush: jscript; title: ; notranslate" title="">
		var author = myObj&#x5B;creatorLabel];
		if (author.length === undefined) {
			author = &quot;n.a.&quot;;
		}
		var title = myObj&#x5B;titleLabel];
		var dateOriginal = myObj&#x5B;dateLabel];
		if (dateOriginal.length === undefined) {
			dateOriginal = &quot;n.d.&quot;;
		}
		var type = myObj&#x5B;typeLabel];
		if (type.length === undefined) {
			type = &quot;n.a.&quot;;
		}
		var collectionName = myObj&#x5B;collectionLabel];
		var institution = myObj&#x5B;institutionLabel];
		var description = myObj&#x5B;descriptionLabel];

</pre>
<p>We will need to know what day today is, as well as what the address of the record is:</p>
<pre class="brush: jscript; title: ; notranslate" title="">

var dateToday = new Date().toISOString().slice(0, 10);
var url = &quot;http://www.idaillinois.org/digital/collection/&quot; + collectionID + &quot;/id/&quot; + recordNumber;

</pre>
<p>And we can then assemble the four citation formats (MLA, Chicago, APA, and IEEE):</p>
<pre class="brush: jscript; title: ; notranslate" title="">
var MLA = &quot;&lt;hr /&gt;\n&lt;h3 style=\&quot;color:#aa0000;\&quot;&gt;Cite this image:&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;MLA (v.8)&lt;/strong&gt;: &quot; + author +  &quot;. \&quot;&quot; + title + &quot;.\&quot; &quot; + institution + &quot;: &quot; + collectionName + &quot; (Illinois Digital Archives),&quot; + dateOriginal + &quot;, &quot; + url + &quot;. &quot; + dateToday + &quot;.&lt;/p&gt;&quot;;

MLA = MLA + &quot;&lt;p&gt;&lt;strong&gt;Chicago/Turabian&lt;/strong&gt;:  &quot; + author + &quot;, &lt;em&gt;&quot; + title + &quot;&lt;/em&gt;, &quot; + collectionName + &quot; (Illinois Digital Archives), &quot; + dateToday + &quot;, &quot; + url + &quot;.&lt;/p&gt;&quot;;

MLA = MLA + &quot;&lt;p&gt;&lt;strong&gt;APA (v.6)&lt;/strong&gt;: &quot; + author + &quot;. (&quot; + dateOriginal + &quot;). &quot; + title + &quot; &#x5B;&quot; + description + &quot;]. Retrieved &quot; + dateToday + &quot;, from &quot; + url + &quot;&lt;/p&gt;&quot;;	

MLA = MLA + &quot;&lt;p&gt;&lt;strong&gt;IEEE&lt;/strong&gt;: &#x5B;X] &quot; + author + &quot;, \&quot;&quot;  + title + &quot;\&quot;, &quot; + institution + &quot;: &quot; + collectionName + &quot; (Illinois Digital Archives),&quot; + dateOriginal + &quot;. &#x5B;Online]. Available: &quot; + url + &quot;. &#x5B;Accessed: &quot; + dateToday + &quot;].&lt;/p&gt;&quot;;
						
citationContainer.innerHTML = MLA;
						
document.querySelector('.ItemView-itemViewContainer').appendChild(citationContainer);	


</pre>
<p>Incidentally, it took some detective work on my part to find the different regions that make up a CONTENTdm item record in order to place the citation &lt;div&gt;. I did a view source on an item record and found a likely CSS file (<a href="http://www.idaillinois.org/digital/f45fcea/app.css"><strong>https://www.idaillinois.org/digital/f45fcea/app.css</strong></a>). I then experimented with the line</p>
<pre class="brush: jscript; title: ; notranslate" title="">
document.querySelector('.ItemView-itemViewContainer').appendChild(citationContainer);
</pre>
<p>to find the proper region of the record for my citation &lt;div&gt;, using likely candidates until I hit upon the proper container.</p>
<p><strong>Link to the whole script</strong>: <a href="https://www.idaillinois.org/customizations/global/js/citation.js">https://www.idaillinois.org/customizations/global/js/citation.js</a></p>
<h3>The End Result</h3>
<p class="caption"><a href="../media/issue53/randles/figure4-large.png"><img decoding="async" src="../media/issue53/randles/figure4-large.png" alt="End result of item metadata and citations below" /></a><br />
<strong>Figure 4.</strong> End result of item metadata and citations below</p>
<h3>Loading Custom JavaScript Programming Into CONTENTdm</h3>
<p>&nbsp;</p>
<p>Because CONTENTdm is now based on the React JS library and environment, a second program is needed to properly load custom JavaScript programs. Shane Huddleston has provided a loader script, <strong><em>loader-1.1.js</em></strong> (<a href="https://cdmdemo.contentdm.oclc.org/digital/custom/recipedownloads"><strong>https://cdmdemo.contentdm.oclc.org/digital/custom/recipedownloads</strong></a>) that will check the ready state of the page being loaded and then execute the listed JS programs. Here is an example of his loader program, which loads an IIIF metadata viewer and then a citation generator:</p>
<p><strong><em>loader.js</em></strong></p>
<pre class="brush: jscript; title: ; notranslate" title="">

'use strict';

// helper function to load js file and insert into DOM
// @param {string} src link to a js file
// @returns Promise

function loadScript(src) {
  return new Promise(function(resolve, reject) {
    const script = document.createElement('script');
/*    script.crossOrigin = 'anonymous'; */
    script.src = src;
    script.onload = resolve;
    script.onerror = reject;
    document.head.appendChild(script);
  });
}

// helper function to assemble full URL of each JS file
function filePath(file) {
  return fileDirectory + file;
}

// path corresponding to directory where JS scripts are uploaded
const fileDirectory = '/customizations/global/js/';

// array containing file names of each JS file
const scriptFilesToLoad = &#x5B;
  'field-insert-iiif.js',
  'citationGenerator.js'
  ];
  (function() {
const allScripts = scriptFilesToLoad.map(filePath);
allScripts.forEach(loadScript);

document.addEventListener('cdm-custom-page:ready', function(e) {
if (e.detail.filename === 'field-insert-iiif') {
	loadScript('/customizations/global/js/field-insert-iiif.js');
	}	
else if (e.detail.filename === 'citation') {
	loadScript('/customizations/global/js/citationGenerator.js');
	}		
});

})();


</pre>
<p>&nbsp;</p>
<h3>Loading Your Programs into CONTENTdm</h3>
<p>In your server administration, go to COLLECTIONS-&gt;WEBSITE-&gt;(login)-&gt;CUSTOM-&gt;CUSTOM SCRIPTS. Browse to the location of your new JS programs on your local computer.</p>
<p>Upload the <strong><em>citation.js</em></strong> program.</p>
<p>Press the SAVE button, and then the PUBLISH button.</p>
<p>The <strong>very last</strong> program to load is the <strong><em>loader.js</em></strong> program. SAVE it, PUBLISH it, and it should work. Please note that the programs must be loaded, saved, and published in this order.</p>
<h2>Conclusion</h2>
<p>Fortunately, we both were able to leverage different aspects of CONTENTdm’s system to provide an effective way to generate citations on the fly for digital collections content. If your collections have the needed citation information in the same fields across collections, the first approach using the IIIF manifest may be best for you. If it varies, try the second approach, and see what works for you. We encourage other institutions using CONTENTdm to try our solutions or develop their own and share it with the wider CONTENTdm user community. We hope that our solutions may lead to a citation recipe in the CONTENTdm cookbook or ideally, even a new feature in a future release.</p>
<h2>About the Authors</h2>
<p>Jenn Randles (<a href="mailto:jenn.randles@tn.gov">jenn.randles@tn.gov</a>) is Enterprise Data Librarian at the State of Tennessee Center for Enterprise Data and Analytics, formerly Digital Materials Librarian at the Tennessee State Library &amp; Archives. Jenn enjoys user experience design, building and maintaining digital collections and data catalogs, and finds satisfaction in making systems accessible for users at any level of tech knowledge.</p>
<p>Andrew Bullen (<a href="mailto:abullen@ilsos.gov">abullen@ilsos.gov</a>) is the Information Technology Coordinator for the Illinois State Library. He works with the preservation and presentation of born-digital state documents, digitized cultural resources, and other digital humanities opportunities. He also works with optical musical recognition and crafting narratives from digital artifacts.</p>
					</div>
														</div>
				<!-- You can start editing here. -->

<div class="comments">
	<p class="subscriptionlinks">Subscribe to comments: <a href="16289/feed">For this article</a> | <a href="http://feeds.feedburner.com/c4lj/comments">For all articles</a></p>

			<!-- If comments are open, but there are no comments. -->

	 

<h3 id="respond">Leave a Reply</h3>


<form action="https://journal.code4lib.org/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value=""/>
<label for="author">Name (required)</label></p>

<p><input type="text" name="email" id="email" value="" />
<label for="email">Mail (will not be published) (required)</label></p>

<p><input type="text" name="url" id="url" value="" />
<label for="url">Website</label></p>


<p><textarea autocomplete="new-password"  aria-label="Comment box" id="f127f6ccbe"  name="f127f6ccbe"   cols="50" rows="10"></textarea><textarea id="comment" aria-label="hp-comment" aria-hidden="true" name="comment" autocomplete="new-password" style="padding:0 !important;clip:rect(1px, 1px, 1px, 1px) !important;position:absolute !important;white-space:nowrap !important;height:1px !important;width:1px !important;overflow:hidden !important;" tabindex="-1"></textarea><script data-noptimize>document.getElementById("comment").setAttribute( "id", "a57fdd4b5f7167b292b780f8a179c70a" );document.getElementById("f127f6ccbe").setAttribute( "id", "comment" );</script></p>

<p><input name="submit" type="submit" id="submit"  value="Submit Comment" />
<input type="hidden" name="comment_post_ID" value="16289" />
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="48d2dd01b5" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="38"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p>
</form>


</div>
							</div>

			<div id="meta">
				<div id="issn">
					<p>ISSN 1940-5758</p>
				</div>
				<div class="search-sidebar">
				<form method="get" id="searchform" action="../index.html">
					<div>
						<input type="text" value="" aria-labelledby="searchsubmit" name="s" id="s" />
						<input type="submit" value="Search" id="searchsubmit"/>
					</div>
				</form>
				</div>
				<div id="archives">
					<h2>Current Issue</h2>
						<ul>
							<li><a href="../issues/issues/issue60.html">Issue 60, 2025-04-14</a></li>
						</ul>

					<h2>Previous Issues</h2>
						<ul>
              <li><a href="../issues/issues/issue59.html">Issue 59, 2024-10-07</a></li><li><a href="../issues/issues/issue58.html">Issue 58, 2023-12-04</a></li><li><a href="../issues/issues/issue57.html">Issue 57, 2023-08-29</a></li><li><a href="../issues/issues/issue56.html">Issue 56, 2023-04-21</a></li>              <li><a href="../index.html%3Fp=2476.html">Older Issues</a></li>
						</ul>
				</div>
				<div id="forauthors">
					<h2>For Authors</h2>
					<ul>
						<li class="page_item page-item-4"><a href="../index.html%3Fp=4.html">Call for Submissions</a></li>
<li class="page_item page-item-7"><a href="../index.html%3Fp=7.html">Article Guidelines</a></li>
					</ul>
				</div>
			</div>
						<div id="footer">
				<p id="login"><a href="../wp-login.php.html">Log in</a></p>
				<p id="copyright">This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 United States License</a>.<br /><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" src="http://i.creativecommons.org/l/by/3.0/us/80x15.png" /></a></p>
			</div>
			<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/c4lj-theme\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js%3Fver=3.0.9b" id="syntaxhighlighter-core-js"></script>
<script type="text/javascript" src="../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js%3Fver=3.0.9b" id="syntaxhighlighter-brush-jscript-js"></script>
<script type="text/javascript" src="../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js%3Fver=3.0.9b" id="syntaxhighlighter-brush-php-js"></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://journal.code4lib.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://journal.code4lib.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script defer type="text/javascript" src="../wp-content/plugins/akismet/_inc/akismet-frontend.js%3Fver=1748382734" id="akismet-frontend-js"></script>
		</div>
	</body>
</html>
