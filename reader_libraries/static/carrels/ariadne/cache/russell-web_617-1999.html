<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="../../css/style.css">

        <title>Web Mirrors: Building the UK Mirror Service - Ariadne</title>

        <meta name="citation_journal_title" content="Ariadne" />
        <meta name="citation_issn" content="1361-3200">

        
            <meta name="citation_title" content="Web Mirrors: Building the UK Mirror Service" />
        

        
            <meta name="citation_publication_date" content="1999" />
        

        
            <meta name="citation_issue" content="22" />
        


        
            
                <meta name="citation_author" content="mark russell" />
            
        

        
            <link rel="alternate" type="application/x-bibtex" href="web-mirror/citation.bibtex.html" title="Ariadne" />
        
            <link rel="alternate" type="application/x-research-info-systems" href="web-mirror/citation.ris" title="Ariadne" />
        

        
    </head>
    <body>
        <header>
            <a id="logo" href="../../index.html"><img src="../../images/logo.png" alt="Home"></a>
            <div id="subtitle">Web Magazine for Information Professionals</div>
            <nav>
                
                    <a href="../../index.html">Home</a>
                
                    <a href="../../current-issue.html">Coming issue</a>
                
                    <a href="../../issue.html">Archive</a>
                
                    <a href="../../author.html">Authors</a>
                
                    <a href="../../articles.html">Articles</a>
                
                    <a href="../../guidelines.html">Guidelines</a>
                
            </nav>
        </header>


<article>
    <header>
        <h1>Web Mirrors: Building the UK Mirror Service</h1>
    </header>


    
    <aside>
        
            
                <h3>Buzz</h3>
                <p id="buzz">
                    
                        
                        
                            <a href="../../buzz/data/index.html">data</a>
                        
                    
                        
                        
                            <a href="../../buzz/software/index.html">software</a>
                        
                    
                        
                        
                            <a href="../../buzz/xml/index.html">xml</a>
                        
                    
                        
                        
                            <a href="../../buzz/apache/index.html">apache</a>
                        
                    
                        
                        
                            <a href="../../buzz/usability/index.html">usability</a>
                        
                    
                        
                        
                            <a href="../../buzz/archives/index.html">archives</a>
                        
                    
                        
                        
                            <a href="../../buzz/copyright/index.html">copyright</a>
                        
                    
                        
                        
                            <a href="../../buzz/z39.50/index.html">z39.50</a>
                        
                    
                        
                        
                            <a href="../../buzz/linux/index.html">linux</a>
                        
                    
                        
                        
                            <a href="../../buzz/rfc/index.html">rfc</a>
                        
                    
                        
                        
                    
                        
                        
                            <a href="../../buzz/cache/index.html">cache</a>
                        
                    
                        
                        
                    
                        
                        
                            <a href="../../buzz/samba/index.html">samba</a>
                        
                    
                        
                        
                            <a href="../../buzz/ftp/index.html">ftp</a>
                        
                    
                        
                        
                            <a href="../../buzz/url/index.html">url</a>
                        
                    
                        
                        
                            <a href="../../buzz/standards/index.html">standards</a>
                        
                    
                </p>
            
        

        <h3>Citation</h3>
        <ul>
            <li><a href="web-mirror/citation.bibtex.html">BibTex</a></li>
            <li><a href="web-mirror/citation.ris">RIS</a></li>
        </ul>
    </aside>
    <div class="summary">
        Report on the UK Mirror Service by <a href="http://www.ariadne.ac.uk/issue22/web-mirror#author1">Mark Russell</a>.
    </div>

    <div class="content">
        <p>On 1st August 1999 the UK Mirror Service <a href="web-mirror.html#ukms">[1]</a> replaced HENSA as the JISC <a href="web-mirror.html#jisc">[2]</a> funded mirror service for the UK academic community. The new service is run by the same teams at Kent and Lancaster that supported the HENSAs, but it is not merely a revamp of the HENSA sites; there are some fundamental changes.</p><p>This article takes a look at the implementation of the service and our plans for the future.</p><h2>A Distributed Service</h2><p>We decided at the outset to locate the service at both Kent and Lancaster, so that the service could survive the loss of either one of the sites. Our experience was that individual sites do occasionally fall off JANET for various reasons (network outages, power cuts, router upgrades etc). These events are infrequent, but happen often enough that there is a real gain in availability of service from the two-site approach.</p><p>The service is also distributed over a group of machines at each site. Incoming Web and FTP requests are handled by a array of <em>front end</em> hosts. These forward the requests to <em>back ends</em> which contain the mirrored data. The front ends cache data from the back ends, but operate independently of each other - there is no attempt to avoid duplication of material between the caching front ends. While this costs some disk space, it does mean that the system scales well to handle the peak demands that occur when new releases of well-known packages appear.</p><p>The key advantage of this arrangement is that it is scalable. As the load increases we can simply add more front ends. The front ends are cheap Intel boxes running Linux <a href="web-mirror.html#linux">[3]</a> and Apache <a href="web-mirror.html#apache">[4]</a>. As the front ends contain only cached data they do not need to be backed up, and setting them up is a trivial process.</p><h2>Mirroring</h2><p>We use a locally developed system called Cftp <a href="web-mirror.html#cftp">[5]</a> to handle mirroring of FTP and Web sites. This had been in use at HENSA Unix since 1997, and has grown robust over the years to handle the vagaries of FTP servers that crash, provide listings in odd formats and violate the FTP RFC <a href="web-mirror.html#ftp">[6]</a> in various interesting ways.</p><p>We needed to change Cftp to support mirroring to both the Kent and Lancaster sites. Our first attempt at this was a master/slave model: Cftp at the master site completed all its updates, then propagated the changes to the slave site. But this meant that updates were lost if the two sites lost network connectivity, and also that the slave site's updates were lost if there were problems at the master site.</p><p>Our second (and current) solution was to make each site carry out mirroring independently, but for each site to look 'sideways' at the other. The mirroring process works like this at each site:</p><ul><li>We build an index file describing the current state of the origin site (the site we are mirroring).</li><li>We use the index file to compare our local copy with the current state of the origin site.</li><li>If we need to update a file, we first look at our peer site to see if it already has an up to date copy. If so, we fetch it from the peer rather than the origin site.</li></ul><p>To avoid both sites working in lock step, one traverses the tree forwards and the other backwards. To handle more than two cooperating sites we would need to use a random order or some other scheme.</p><p>This scheme has worked well in practice. Although the two sites are handling mirroring independently, there is very little duplicated copying of resources.</p><h2>Mirror Status Information</h2><p>A problem with most mirror sites is that you have no idea how up to date they are. Most sites attempt an update at least daily, but the mirroring process is vulnerable to various failure modes at the origin sites, the mirror site or the network. Typically the user has no way of knowing whether a mirror site is up to date, and we felt that this was a significant factor deterring people from using mirrors.</p><p>We therefore decided to label each mirrored directory with last mirrored information. This includes the time the index file was generated and when the directory itself was compared with the origin site. Cftp maintains this information in a status file stored in each directory. We felt it was important to timestamp each directory individually rather than just keeping a 'last mirrored' timestamp for each origin site, because mirroring can fail part way through an update.</p><p>The mirroring process also maintains other information in the status file, including when each file in the directory was last copied, error messages for attempted updates that failed and total size information for directories. Currently this information is only used to show last updated and total size information via the web interface, but we plan to extend this soon. For example, we will make the FTP server show directory timestamps that indicate the last modified time of the most recently changed file anywhere below the directory.</p><p>We also plan to use the status files to indicate which files have <em>not</em> been copied. Mirror sites are traditionally more or less selective about what they copy, but again users have no way of knowing what has been left out. Because of this the UK Mirror Service has up to now been fairly conservative, typically mirroring everything except files that are duplicated elsewhere in the archive. Explicit labelling of what has been skipped will let us omit 'dead' items - old releases of software for example - that are not often accessed. The Web interface could display these items as links to the origin server copies (we could also do this under the FTP interface).</p><h2>Configuration</h2><p>Under HENSA we maintained various configuration files which controlled the mirroring process and the Web and FTP servers. Adding a new mirror involved updates to all of these files. The UK Mirror Service uses a different approach: all the information about a mirror is contained in a single per-mirror XML <a href="web-mirror.html#xml">[7]</a> file. Among other things this file contains:</p><ul><li>A description of the site</li><li>Contact information</li><li>Where the site should appear in the Web and FTP trees</li><li>How the site should be mirrored</li></ul><p>These files are used to generate the configuration files for the Web and FTP servers, which are then automatically propagated to the front and back end servers. The use of XML means that we can easily extend the mirror description files with additional information (for example, if we wished to use an alternative method of mirroring).</p><h2>Searching</h2><p>Searching at HENSA was implemented with in-house tools, and had different implementations and user interfaces at the Unix and Micros sites. For the UK Mirror Service we are using Zebra <a href="web-mirror.html#zebra">[8]</a>, which is a Z39.50 <a href="web-mirror.html#z3950">[9]</a> based indexing system. Locally developed scripts handle the extraction of index information (e.g. descriptive text from Linux RPM <a href="web-mirror.html#rpm">[10]</a> files) and the construction of a single search index for the whole site.</p><p>We view effective search support as critical to the usability of the UK Mirror Service. We have concentrated up to now on building the foundations for a powerful search system, but the user interface is at present far from ideal (frankly due to the pressure of time). In particular many users have complained of the lack of a platform-based search facility. Thus work on the searching user interface is a high priority at present.</p><p>The first step is to add basic platform-specific search support. After that we plan to extend the extraction of descriptive text from the various package formats; for example README files and the like from software distributions. Also planned is intelligent handling of multiple versions of packages - usually the current version of a package is the only one of interest.</p><h2>Future work</h2><p>We have a number of projects planned for the short and medium term. Right now we are working on improvements to the searching user interface as described in the previous section. We are also looking at extending our coverage, particularly of material outside the traditional area of software packages.</p><p>We are currently looking at ways to making the Mirror Service work with the National Janet Web Caching Service <a href="web-mirror.html#wwwcache">[11]</a>. There is obvious scope for the UK Mirror Service to satisfy requests for FTP URLs. We are in the early stages of collaboration with the National Web Cache to develop support for this.</p><p>The archive is currently accessible via the Web or by FTP. We would like to add NFS <a href="web-mirror.html#nfs">[12]</a> and Samba <a href="web-mirror.html#samba">[13]</a> access, but this will need some software development to support effectively. Because the archive is distributed over several machines we cannot use standard software to support NFS access, but we should be able to modify freely available NFS server software to do the job.</p><p>We would like to offer added value for popular items, such as prebuilt binary versions of some source packages, and perhaps UK- or mirror- specific help for some very popular items (e.g. 'How to install Linux from the UK Mirror Service'). We also plan substantial enhancements to our tutorial information, including additional help on things like file formats and software installation.</p><p>A slightly longer term project is to set up a user forum to allow people to review resources, as well as provide helpful information. This would require careful nurturing and steering if it is to succeed, but we think it would be extremely useful.</p><p>As well as these externally visible improvements, there is much internal work to do. For example, we would like to implement automatic failover between the front end Web servers, so that if one machine fails another immediately takes over its IP address. We would also like to make the front end hosts automatically handle failure of a back end server by switching to the alternative host.</p><p>Another mundane but important area of work is in improved processing of access logs. As can be imagined we generate large amounts of log files, and buried in there is valuable information about what is popular, who is using the service, etc.</p><p>In conclusion, please try out the service and let us know what you think. We particularly welcome suggestions for resources or facilities you would like to see added to the site. Our aim is to provide what our users need, and to do that we need feedback from you.</p><h2>References</h2><ol><li><em><a name="ukms">The UK Mirror Service</a></em><br><a href="http://www.mirror.ac.uk/">http://www.mirror.ac.uk/</a></li><li><em><a name="jisc">The Joint Information Systems Committee</a></em><br><a href="http://www.jisc.ac.uk/">http://www.jisc.ac.uk/</a></li><li><em><a name="linux">The Linux operating system</a></em><br><a href="http://www.linux.org/">http://www.linux.org/</a></li><li><em><a name="apache">The Apache web server</a></em><br><a href="http://www.apache.org/">http://www.apache.org/</a></li><li><em><a name="cftp">Cftp: A Caching FTP Server</a></em><br>Computer Networks and ISDN Systems 30 (1998) 2211-2222</li><li><em><a name="ftp">RFC 959: File Transfer Protocol</a></em><br><a href="ftp://ftp.isi.edu/in-notes/rfc959.txt">ftp://ftp.isi.edu/in-notes/rfc959.txt</a></li><li><em><a name="xml">XML: Extensible Markup Language</a></em><br><a href="http://www.w3.org/XML/">http://www.w3.org/XML/</a></li><li><em><a name="zebra">The Zebra Server</a></em><br><a href="http://www.indexdata.dk/zebra/">http://www.indexdata.dk/zebra/</a></li><li><em><a name="z3950">Z39.50</a></em><br><a href="http://www.cni.org/projects/z3950/z3950dir.html">http://www.cni.org/projects/z3950/z3950dir.html</a></li><li><em><a name="rpm">The RPM software packaging tool</a></em><br><a href="http://www.rpm.org/">http://www.rpm.org/</a></li><li><em><a name="wwwcache">The National JANET Web Cache</a></em><br><a href="http://wwwcache.ja.net/">http://wwwcache.ja.net/</a></li><li><em><a name="nfs">The NFS Distributed File Service</a></em><br><a href="http://www.sun.com/software/white-papers/wp-nfs/">http://www.sun.com/software/white-papers/wp-nfs/</a></li><li><em><a name="samba">The Samba file and print service</a></em><br><a href="http://www.samba.org/">http://www.samba.org/</a></li></ol><h3>Author details</h3><table border="0" cellpadding="3"><tbody><tr><td valign="middle">&nbsp;</td><td><address><p>Mark Russell<br>Technical Director,<br>The UK Mirror Service<br><a href="mailto: M.T.Russell@ukc.ac.uk">M.T.Russell@ukc.ac.uk</a></p></address></td></tr></tbody></table><div class="UKOLN-page-footer"><p align="center"><!-- <A HREF="../issue19/xxx/"><IMG SRC="../../icon/earlier-issue.gif" BORDER="0" ALT="Same column in last issue" WIDTH="115" HEIGHT="28"></A>--><!--<A HREF="../issue21/xxx/"><IMG SRC="../../icon/later-issue.gif" BORDER="0" ALT="Same column in next issue" WIDTH="115" HEIGHT="28"></A>--></p><blockquote><small><strong>Article Title</strong>: "Building the UK Mirror Service - Foundations First"<br><strong>Author</strong>: Mark Russell<br><strong>Publication Date</strong>: 21-Dec-1999<br><strong>Publication</strong>: Ariadne Issue 22<br><strong>Originating URL</strong>: http://www.ariadne.ac.uk/issue22/web-mirror<b>/</b></small></blockquote></div><p>&nbsp;</p>

    </div>

    <footer>
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3A%2F%2Fsharingbuttons.io" target="_blank" aria-label="Facebook">
    <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm3.6 11.5h-2.1v7h-3v-7h-2v-2h2V8.34c0-1.1.35-2.82 2.65-2.82h2.35v2.3h-1.4c-.25 0-.6.13-.6.66V9.5h2.34l-.24 2z"/></svg></div>Facebook</div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Super%20fast%20and%20easy%20Social%20Media%20Sharing%20Buttons.%20No%20JavaScript.%20No%20tracking.&amp;url=http%3A%2F%2Fsharingbuttons.io" target="_blank" aria-label="Twitter">
    <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm5.26 9.38v.34c0 3.48-2.64 7.5-7.48 7.5-1.48 0-2.87-.44-4.03-1.2 1.37.17 2.77-.2 3.9-1.08-1.16-.02-2.13-.78-2.46-1.83.38.1.8.07 1.17-.03-1.2-.24-2.1-1.3-2.1-2.58v-.05c.35.2.75.32 1.18.33-.7-.47-1.17-1.28-1.17-2.2 0-.47.13-.92.36-1.3C7.94 8.85 9.88 9.9 12.06 10c-.04-.2-.06-.4-.06-.6 0-1.46 1.18-2.63 2.63-2.63.76 0 1.44.3 1.92.82.6-.12 1.95-.27 1.95-.27-.35.53-.72 1.66-1.24 2.04z"/></svg></div>Twitter</div>
</a>


<a class="resp-sharing-button__link" href="https://plus.google.com/share?url=http%3A%2F%2Fsharingbuttons.io" target="_blank" aria-label="Google+">
    <div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.65 8.6c-.02-.66-.3-1.3-.8-1.8S10.67 6 9.98 6c-.63 0-1.2.25-1.64.68-.45.44-.68 1.05-.66 1.7.02.68.3 1.32.8 1.8.96.97 2.6 1.04 3.5.14.45-.45.7-1.05.67-1.7zm-2.5 5.63c-2.14 0-3.96.95-3.96 2.1 0 1.12 1.8 2.08 3.94 2.08s3.98-.93 3.98-2.06c0-1.14-1.82-2.1-3.98-2.1z"/><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm-1.84 19.4c-2.8 0-4.97-1.35-4.97-3.08s2.15-3.1 4.94-3.1c.84 0 1.6.14 2.28.36-.57-.4-1.25-.86-1.3-1.7-.26.06-.52.1-.8.1-.95 0-1.87-.38-2.57-1.08-.67-.68-1.06-1.55-1.1-2.48-.02-.94.32-1.8.96-2.45.65-.63 1.5-.93 2.4-.92V5h3.95v1h-1.53l.12.1c.67.67 1.06 1.55 1.1 2.48.02.93-.32 1.8-.97 2.45-.16.15-.33.3-.5.4-.2.6.05.8.83 1.33.9.6 2.1 1.42 2.1 3.56 0 1.73-2.17 3.1-4.96 3.1zM20 10h-2v2h-1v-2h-2V9h2V7h1v2h2v1z"/></svg></div>Google+</div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Super%20fast%20and%20easy%20Social%20Media%20Sharing%20Buttons.%20No%20JavaScript.%20No%20tracking.&amp;body=http%3A%2F%2Fsharingbuttons.io" target="_self" aria-label="E-Mail">
    <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm8 16c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v8z"/><path d="M17.9 8.18c-.2-.2-.5-.24-.72-.07L12 12.38 6.82 8.1c-.22-.16-.53-.13-.7.08s-.15.53.06.7l3.62 2.97-3.57 2.23c-.23.14-.3.45-.15.7.1.14.25.22.42.22.1 0 .18-.02.27-.08l3.85-2.4 1.06.87c.1.04.2.1.32.1s.23-.06.32-.1l1.06-.9 3.86 2.4c.08.06.17.1.26.1.17 0 .33-.1.42-.25.15-.24.08-.55-.15-.7l-3.57-2.22 3.62-2.96c.2-.2.24-.5.07-.72z"/></svg></div>E-Mail</div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=http%3A%2F%2Fsharingbuttons.io&amp;media=http%3A%2F%2Fsharingbuttons.io&amp;description=Super%20fast%20and%20easy%20Social%20Media%20Sharing%20Buttons.%20No%20JavaScript.%20No%20tracking." target="_blank" aria-label="Pinterest">
    <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm1.4 15.56c-1 0-1.94-.53-2.25-1.14l-.65 2.52c-.4 1.45-1.57 2.9-1.66 3-.06.1-.2.07-.22-.04-.02-.2-.32-2 .03-3.5l1.18-5s-.3-.6-.3-1.46c0-1.36.8-2.37 1.78-2.37.85 0 1.25.62 1.25 1.37 0 .85-.53 2.1-.8 3.27-.24.98.48 1.78 1.44 1.78 1.73 0 2.9-2.24 2.9-4.9 0-2-1.35-3.5-3.82-3.5-2.8 0-4.53 2.07-4.53 4.4 0 .5.1.9.25 1.23l-1.5.82c-.36-.64-.54-1.43-.54-2.28 0-2.6 2.2-5.74 6.57-5.74 3.5 0 5.82 2.54 5.82 5.27 0 3.6-2 6.3-4.96 6.3z"/></svg></div>Pinterest</div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fsharingbuttons.io&amp;title=Super%20fast%20and%20easy%20Social%20Media%20Sharing%20Buttons.%20No%20JavaScript.%20No%20tracking.&amp;summary=Super%20fast%20and%20easy%20Social%20Media%20Sharing%20Buttons.%20No%20JavaScript.%20No%20tracking.&amp;source=http%3A%2F%2Fsharingbuttons.io" target="_blank" aria-label="LinkedIn">
    <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solidcircle">
    <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <path d="M12,0C5.383,0,0,5.383,0,12s5.383,12,12,12s12-5.383,12-12S18.617,0,12,0z M9.5,16.5h-2v-7h2V16.5z M8.5,7.5 c-0.553,0-1-0.448-1-1c0-0.552,0.447-1,1-1s1,0.448,1,1C9.5,7.052,9.053,7.5,8.5,7.5z M18.5,16.5h-3V13c0-0.277-0.225-0.5-0.5-0.5 c-0.276,0-0.5,0.223-0.5,0.5v3.5h-3c0,0,0.031-6.478,0-7h3v0.835c0,0,0.457-0.753,1.707-0.753c1.55,0,2.293,1.12,2.293,3.296V16.5z" />
    </svg></div>LinkedIn</div>
</a>


    </footer>
</article>

        <footer>
            <p>Ariadne is published by <a href="http://www.lboro.ac.uk/library/" target="_blank">Loughborough University Library</a></p>
            <p>&copy; Ariadne ISSN: 1361-3200. See our explanations of <a href="../../about/copyright.html" title="Explanation of Access Terms and Copyright">Access Terms and Copyright</a> and <a href="../../privacy-statement.html">Privacy Statement</a>.</p>
        </footer>
    </body>
</html>

