<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="DOI" content="10.1045/september2011-neatrour" />
<meta name="description" content="D-Lib Magazine" /> 
<meta name="keywords" content="D-Lib Magazine, Digital Libraries, Digital Library Research" />
<link rel="metadata" href="09neatrour.meta.xml" /> 
<link href="../../../style/style1.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon" />
<title>Automating the Production of Map Interfaces for Digital Collections Using Google APIs</title>
</head>

<body>
<form action="https://www.dlib.org/cgi-bin/search.cgi" method="get">

<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#2b538e">
<tr>
<td><img src="../../../img2/space.gif" alt="" width="10" height="2" /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="bottom" colspan="4" align="right" bgcolor="#4078b1">

<table border="0">
<tr>
<td align="right" class="search"><img src="../../../img2/search2.gif" alt="" width="51" height="20" align="middle" />Search D-Lib:</td>

<td>
<input type="text" name="words" value="" size="25" />
</td>

<td align="left" valign="middle">
<input type="submit" name="search" value="Go!" />
<input type="hidden" name="config" value="htdig" />
<input type="hidden" name="restrict" value="" />
<input type="hidden" name="exclude" value="" /> 
</td>
</tr>
</table>

</td></tr></table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="bottom" colspan="4">

<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#e04c1e" id="outer" summary="Main Table">
<tr>
<td><img src="../../../img2/space.gif" alt="" width="10" height="1" /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#F6F6F6" id="bannertable">
  <tr>
    <td width="830" bgcolor="#4078b1" class="backBannerImage" align="left"><img src="../../../img2/D-Lib-blocks.gif" alt="D-Lib Magazine" width="450" height="100" border="0" /></td>
  </tr>
  <tr>
    <td width="830" bgcolor="#e04c1e"><img src="../../../img2/transparent.gif" alt="spacer" height="1" /></td>
  </tr>
  <tr>
    <td width="830" bgcolor="#eda443" align="left"><img src="../../../img2/magazine.gif" alt="The Magazine of Digital Library Research" width="830" height="24" border="0" /></td>
  </tr>
  <tr>
    <td width="830" bgcolor="#e04c1e"><img src="../../../img2/transparent.gif" alt="spacer" height="1" /></td>
   </tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0" id="navtable">
  <tr>
    <td width="5" height="20" bgcolor="#2b538e">&nbsp;</td>
    <td width="24" height="20" bgcolor="#2b538e"><img src="../../../img2/transparent.gif" alt="" width="24" height="20" /></td>
    <td height="20" align="left" bgcolor="#2b538e" class="navtext" nowrap="nowrap"><a href="../../../dlib.html">HOME</a>&nbsp;|&nbsp;<a href="../../../about.html">ABOUT D-LIB</a>&nbsp;|&nbsp;<a href="../../../contents.html" class="navtext">CURRENT ISSUE</a>&nbsp;|&nbsp;<a href="../../../back.html">ARCHIVE</a>&nbsp;|&nbsp;<a href="../../../author-index.html">INDEXES</a>&nbsp;|&nbsp;<a href="../../../groups.html">CALENDAR</a>&nbsp;|&nbsp;<a href="../../author-guidelines.html">AUTHOR GUIDELINES</a>&nbsp;|&nbsp;<a href="https://www.dlib.org/mailman/listinfo/dlib-subscribers">SUBSCRIBE</a>&nbsp;|&nbsp;<a href="../../letters.html">CONTACT D-LIB</a></td>
    <td width="5" height="20" bgcolor="#2b538e">&nbsp;</td>
  </tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td width="55" height="1" bgcolor="#e04c1e"><img src="../../../img2/space.gif" alt="transparent image" width="1" height="1" /></td></tr>
</table>

<!-- CONTENT TABLE -->
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
  <td>
 
<!-- BEGIN MAIN CONTENT TABLE -->

<table width="100%" border="0" cellspacing="0" cellpadding="10" bgcolor="#ffffff">
<tr>

<td width="10"><img src="../../../img2/space.gif" alt="" width="1" height="1" /></td>

<td valign="top"> 

<h3 class="blue-space">D-Lib Magazine</h3>
<p class="blue">September/October 2011<br />
Volume 17, Number 9/10<br />
<a href="../09contents.html">Table of Contents</a>
</p> 

<div class="divider-full">&nbsp;</div>

<h3 class="blue-space">Automating the Production of Map Interfaces for Digital Collections Using Google APIs</h3>

<div class="blue">
<table>
<tr>
<td>
<p class="blue">
Anna Neatrour<br />The University of Utah<br />
<a href="https://www.dlib.org/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="35545b5b541b5b505441475a4047754041545d1b505140">[email&#160;protected]</a></p>
</td>

<td>
<p class="blue">
Anne Morrow<br />The University of Utah<br />
<a href="https://www.dlib.org/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b7d6d9d9d299dad8c5c5d8c0f7c2c3d6df99d2d3c2">[email&#160;protected]</a></p>
</td>

<td>
<p class="blue">
Ken Rockwell<br />The University of Utah<br />
<a href="https://www.dlib.org/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c7aca2a9e9b5a8a4acb0a2abab87b2b3a6afe9a2a3b2">[email&#160;protected]</a></p>
</td>

<td>
<p class="blue">
Alan Witkowski<br />The University of Utah<br />
<a href="https://www.dlib.org/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4b5b8b5bafaa3bda0bfbba3a7bfbd94a1a0b5bcfab1b0a1">[email&#160;protected]</a></p>
</td>
</tr>
</table>
</div>

<p class="blue">doi:10.1045/september2011-neatrour</p>

<div class="divider-full">&nbsp;</div>

<p class="blue"><a href="09neatrour.print.html" class="fc">Printer-friendly Version</a></p>

<div class="divider-full">&nbsp;</div>

 <!-- Abstract or TOC goes here --> 

<h3 class="blue">Abstract</h3>

<p class="blue">
Many digital libraries are interested in taking advantage of the GIS mapping capabilities provided by Google Maps and Google Earth. The Digital Ventures Division of the University of Utah J. Willard Marriott Library has successfully completed an innovative automated process in which descriptive metadata in the form of place names was used to determine latitude and longitude coordinates for digital collection items. By enhancing digital collection metadata in this fashion, hundreds of records were updated without data entry from project staff. This article will provide an overview of using the Google application programming interface (API) to return geographic coordinate data, the scripting process with XML digital collection data, and the use of online tools and Microsoft Excel to upload digital collection data to Google Earth and Google Maps. The ability to automate metadata changes opens up a variety of possibilities for digital library administrators and collection managers. 
</p>

<!-- Article goes next --> 

<div class="divider-full">&nbsp;</div>
<h3>Introduction</h3>

<p>Many institutions and individuals have begun exploring the use of geographic data to provide an alternate means of accessing digital library collections. Providing additional search interfaces offers new ways for users to engage with digital library content. Understanding of collection items that reflect real world locations is enhanced when users have the ability to view items grouped by state, county or city. A significant value of geographic browsing for a digital library is assisting discoverability, particularly with collections containing large amounts of content. A digital library visitor can easily be overwhelmed by the prospect of browsing a collection of thousands of items distributed over dozens of browser windows. As a result, spatial browsing interfaces have become a popular solution because of their ability to help the digital library visitor access large volumes of content more efficiently. </p>

<p>At the <a href="http://www.lib.utah.edu/">J. Willard Marriott Library</a>, many of our digital collections have strong regional interest, and enhancing discoverability by allowing users to visually browse for materials in nearby counties, cities, or states provides an ideal way to showcase our unique collections. We partner with a variety of local institutions to host regional materials. For example, the <a href="http://history.utah.gov/research_and_collections/photos/">Utah State Historical Society</a> collections contain thousands of historical photos from the late nineteenth through the mid-twentieth century and <a href="http://content.lib.utah.edu/cdm4/az_details.php?id=5">Uintah County Library's Photograph</a> collections contain several thousand historical images. The J. Willard Marriott Library's <a href="http://www.lib.utah.edu/collections/multimedia-archives/">Multimedia Archives</a> has more than 40,000 images. Due to the high volume of regionally-relevant content in our digital collections, developing a procedure for adding geographic coordinate data to digital content has been a strategic goal. </p>

<p>As we began to develop our strategy for incorporating geographic coordinates, we approached the problem from two different perspectives. First, we addressed incoming collections and content during the production phase in order to avoid retroactive collection editing. Our second strategy was to focus on preexisting collections and content with strong place name metadata. For new content and collections, we initially explored using a crosswalk to transfer coordinate data collected by image capture software to the content management system. This strategy ended up being inefficient and time-consuming, and applied only to images that originated from a digital source. Most of the materials added to our digital collections are historic, without the data that comes from photos captured with modern digital cameras.  After investigating this option, we realized that it would be far more efficient to capitalize on the robust place name metadata in existing collections, and the solution could work equally well with incoming materials. </p>

<p>We explored the possibility of creating an automated process for looking up and returning latitude and longitude for place names. We already knew it was possible to modify and re-ingest our core collection metadata. In an experiment to take full advantage of the automated processes available we decided to take the results of a geographic lookup script and add the coordinate data to new latitude and longitude fields. A program for manually adding coordinate data and exporting to third party programs like <a href="https://www.google.com/earth/index.html">Google Earth</a> and <a href="https://maps.google.com/">Google Maps</a> was already well in place by the time we explored utilizing a script and place name metadata to capture coordinates. Once we had verified the opportunity to use an automated means of coordinate capture we were able to connect preexisting workflows for re-ingest, metadata export and map creation.</p>

<p>Sources consulted in preparation for this project included information that the Los Gatos library in New Mexico shared about using <a href="http://www.contentdm.org/">CONTENTdm</a> and XML to create Google maps at a Western CONTENTdm users meeting.<sup><a href="09neatrour.html#1">1</a></sup>  The Mountain West Digital Library has also experimented with creating maps for alternate collection access, and we used templates created by the MWDL as models when preparing our own data.<sup><a href="09neatrour.html#2">2</a></sup></p>

<p>In an effort to create more robust geographic data for the collection, we developed a three step process:</p>

<p class="indentLeft">
1) Use the Google Geocoding API to return latitude and longitude data based on existing place names in the metadata.<br />
2) Create a table and scripting program to add the new latitude and longitude values to the core metadata XML file within CONTENTdm.<br />
3) Upload links to the digital collection items with the newly compatible latitude and longitude data to GoogleMaps.</p>

<p>While the second step in the process applies directly to institutions using CONTENTdm as the base software for their digital libraries, steps 1 and 3 can be completed by any digital library running any type of digital library software. This article is designed to provide a detailed overview of our workflow and software development process, so librarians working with application programmers can explore implementing a similar program with their own digital collections. The map generated with this process is available at <a href="http://westernsoundscape.org/googleMap.php">http://westernsoundscape.org/googleMap.php</a>.</p>

<p>The Geocoding Working Group at the J. Willard Marriott Library included a project manager, a metadata librarian in charge of quality assurance, a digital initiatives librarian who explored GIS products and processes, and a computer programmer who developed two customized programs to look up geographic data and add it to the digital collection.</p>


<div class="divider-full">&nbsp;</div>
<h3>Place Name Metadata and the Google Geocoding API</h3>

<p>While the prospect of updating multiple records automatically through a scripting program offers the opportunity to save on staff time, preparing the collection for the scripting process represented an investment in quality assurance from the metadata librarian working on the project. For the first trial of this process, the Geocoding Working Group chose the <a href="http://westernsoundscape.org/">Western Soundscape Archive</a>, a digital library of over 2,600 animal, natural, and manmade sounds with a regional focus on the American West<sup><a href="09neatrour.html#3">3</a></sup>. The Western Soundscape Archive has robust place name data, and the coordinates derived from these place names represent the approximate listening area and not the actual recording location. </p>

<p>Figure 1 shows part of a typical Western Soundscape Archive record with multiple place name metadata.</p>

<div align="center">
<img src="neatrour-fig1.png" alt="Figure Showing Metadata" width="646" height="220" class="border" vspace="10" /><br />
<i>Figure 1: Sample Western Soundscape Archive item metadata.</i></div>

<p>The first custom program developed by the programmer is a Google Geocoding API Lookup script. To automate the task of geocoding, the scripting language PHP and the command-line tool cURL are used in conjunction with Google's Geocoding API<sup><a href="09neatrour.html#4">4</a></sup>. First we export a list of unique place names. For digital libraries using software that supports import and export of collection data in XML files, the locations can be extracted easily with PHP's <i>preg_match</i> function, which is a regular expression matcher used to look for the applicable xml tag, in our case "covspa."</p>

<p>The following is an example from WSA XML. "covspa" is the CONTENTdm nickname for the Dublin Core Element Coverage-Spatial.</p>

<p class="indentLeft">&lt;covspa&gt;Pima County (Ariz.); Sonoran Desert (Ariz.); Arizona&lt;/covspa&gt;</p>

<p>The Google Geocoding API Lookup script searches for all occurrences of &lt;covspa&gt;, reads the metadata, and breaks it up into distinct locations based on semicolons as a separator. Each location is put into an associative array that is later output into a comma-separated values (CSV) file. This spreadsheet is then manually reviewed for errors in the metadata. The second part of our script iterates through the location list, sending locations to the Google Geocoding API one at a time. This is done with the cURL library in PHP, which provides a mechanism for the API to transmit data using a variety of protocols, including automated HTTP requests. Google sends coordinates back if it finds a match. The coordinates are saved and then used to create a table populated with both the place names for the collection and their applicable geographic coordinates<sup><a href="09neatrour.html#5">5</a></sup>. </p>

<p>Google Earth supports a variety of geographic notations<sup><a href="09neatrour.html#6">6</a></sup>.  After consulting various standards for geographic metadata<sup><a href="09neatrour.html#7">7</a></sup>, we chose to use decimal degrees for our latitude and longitude data. The metadata librarian ranked the place names and coordinates, so we were able to assign the most specific latitude and longitude coordinates to items with multiple place names in their metadata. This ranking system is necessary to get the subsequent script to update the item with the most local and accurate coordinate data. Since we have multiple place names in records separated by semicolons, the scripting program populates the latitude and longitude fields with the most specific information first. This process would not be necessary for other library collections where items have only one place name assigned. See <a href="09neatrour.html#appendix">Appendix Item 1</a> for the coordinate ranking system.</p>

<div class="divider-full">&nbsp;</div>
<h3>Using the latitude and longitude values to update the core XML file for the Western Soundscape collection</h3>

<p>The second script is an XML Modification script which takes the table of coordinate pairs and collection place names returned by the Google Geocoding API lookup script and inserts them into the core descriptive metadata file for the collection. This is done by loading the table into an associative array in PHP. Each entry in the array contains the location, priority, and coordinates for fast look-up during the conversion process. Since only one coordinate pair is assigned per record, the locations are ranked and chosen by the highest priority number using the loaded table. If two locations have the same priority, then the first one is chosen. </p>

<p>Sample output:</p>
<p class="indentLeft">&lt;covspa&gt;Pima County (Ariz.); Sonoran Desert (Ariz.); Arizona&lt;/covspa&gt;<br />
&lt;latitu&gt;32.057499&lt;/latitu&gt;<br />
&lt;longit&gt;-111.6660725&lt;/longit&gt;</p>

<p>We first performed the operation on a test version of the collection on a test server. See <a href="09neatrour.html#appendix">Appendix Item 2</a> for an outline of the process in a CONTENTdm collection. We found occasional issues with accuracy of the GoogleAPI's coordinate information, particularly in cases where the descriptive metadata listed a broad geographic area. </p>

<div class="divider-full">&nbsp;</div>
<h3>Uploading Revised Metadata to GoogleMaps</h3>

<p>Once the new latitude and longitude coordinates are in the metadata for the collection, the next step is to use the updated metadata to generate a KML file<sup><a href="09neatrour.html#8">8</a></sup> that can be used in GoogleMaps applications. The display mechanism for a collection populated with latitude and longitude coordinates depends on the number of coordinate points in the collection.  Google MyMaps has size limits that restrict KML file rendering<sup><a href="09neatrour.html#9">9</a></sup>. This general process can be repeated for digital libraries run on software that supports the export of tab delimited collection metadata. The complete set of instructions that apply to a digital library running CONTENTdm is available in <a href="09neatrour.html#appendix">Appendix Item 3</a>.</p>

<p>Producing a KML file populated with objects housed in CONTENTdm begins with massaging exported item-level metadata in Excel. Basic descriptive metadata for each item, such as title, recording description, latitude, longitude, reference URL (item level link in CONTENTdm), and item number, are included in the Excel spreadsheet. We do not include the degree symbol in our geographic data in Excel, as early testing revealed that the default settings in Excel would result in errors parsing the symbol without additional edits. To comply with Google Maps requirements for objects, the latitude, longitude and description fields are edited and an icon field is added. Latitude and longitude cells are formatted up to six decimal places and the icon column is assigned the numerical code for the Google Maps icon<sup><a href="09neatrour.html#10">10</a></sup>. </p>

<p>The most complex modifications involve object description. The original, exported description metadata field is renamed in the spreadsheet and a new description field is added in order to allow the object's description to have a broader set of features including URL, thumbnail image and additional descriptive metadata.  The method for combining these elements is to use a concatenation formula in Excel<sup><a href="09neatrour.html#11">11</a></sup>.  Concatenation formulas allow merger and repetition of columns in a specified order.  </p>

<div align="center">
<img src="neatrour-fig2.png" alt="Figure Showing Concatenation Formula in Excel" width="712" height="258" class="border" vspace="10" /><br />
<i>Figure 2: Creating a concatenation formula.</i></div>

<p>To generate thumbnails we add columns of script that, with exported item identification metadata, execute a command to generate hyperlinked thumbnails. In the formula we include additional descriptive metadata (place name, recording description) and add the persistent URL for the object in CONTENTdm. A final step involves adding a blank second row with a command to allow the Description column to exceed 256 characters. </p>

<p>The cells that are merged by the concatenation formula return formatted HTML that can be imported into Google Maps:</p>

<p class="indentLeft">&lt;a href=""&gt; &lt;img style="width:243px" src="<a href="http://content.lib.utah.edu/cgi-bin/thumbnail.exe?CISOROOT=/wss&amp;CISOPTR=1863">http://content.lib.utah.edu/cgi-bin/thumbnail.exe?CISOROOT=/wss&CISOPTR=1863</a>"&gt; &lt;/a &gt; &lt;br&gt; Audio tracks of animal sounds Merced National Wildlife Refuge (Calif.); Merced County (Calif.); California <a href="http://content.lib.utah.edu/u?/wss,1863">http://content.lib.utah.edu/u?/wss,1863</a></p>

<div align="center">
<img src="neatrour-fig3.png" alt="Figure Showing Data in Excel" width="803" height="394" class="border" vspace="10" /><br />
<i>Figure 3: Thumbnail generation scripting, completed concatenation formula and blank row were added.</i></div>

<p>The formatted spreadsheet is converted to a KML file in a two-step process. In the first step, Earth Point's Excel to KML tool<sup><a href="09neatrour.html#12">12</a></sup>  and its View in Google Earth feature are used to open the spreadsheet within the Google Earth interface.  As a result of the formatting in the spreadsheet, each row is represented as an individual pinpoint, georeferenced according to coordinate data. The pinpoint content includes the elements of the concatenation formula, in our case, a hyperlinked thumbnail, selected descriptive metadata and the persistent URL. Next, the Google Earth file is saved as a KML file by using the option Save Place As in Google Earth. (Earth Point has a View File on Web Page option that is a useful quality control measure. Earth Point is available free of charge if working with 200 or fewer entries.)</p>

<p>For embedded maps using the Google Maps API, the KML file can be saved and imported directly into a webpage. If one wants to bypass the Google Maps API, one can import the map in "Google My Maps" and embed the HTML or post a link. Additional "Google My Maps" features are available for customizing the size and magnification. If your collection contains more than 200 geographic coordinates, you should experiment with display options using the <a href="http://www.gmodules.com/ig/creator?synd=open&amp;url=http://code.google.com/apis/kml/embed/embedkmlgadget.xml">Google Embed KML gadget</a>, which allows you to generate custom maps based on a KML file that you upload to a server. </p>

<div class="divider-full">&nbsp;</div>
<h3>Conclusion</h3>

<p>Completing this process successfully has opened up a variety of possibilities at the J. Willard Marriott Library. We are currently reviewing other digital collections with place-name metadata in order to select additional candidate collections that can be enhanced with additional geographic coordinate data. At this time there are several map projects underway at the library, including a map containing georeferenced historic images from the Utah State Historical Society and a map based on the content of the Hidden Water collection which focuses on the surface water systems of the Salt Lake Valley.</p>

<p>While for the time being our efforts will continue to be directed towards replicating the Google mapping process on additional collections, we also plan to continue developing geographic interfaces. What we have set our sights on next are enhancing the maps by including temporal layers; aggregating content sharing spatial and temporal relationships from multiple collections in subject or theme-focused maps; and exploring options for implementing search, retrieval and recommender systems designed to operate within a geographic interface.  </p>

<div class="divider-full">&nbsp;</div>
<h3>Acknowledgements</h3>

<p>We would like to thank Sandra McIntyre for sharing her expertise with georeferencing metadata. John Herbert, Kenning Arlitsch, Jeff Rice, and Ann Marie Breznay provided valuable feedback on a draft of this paper. The Western Soundscape Archive was founded by Jeff Rice and Kenning Arlitsch and was supported by a major grant from the Institute of Museum and Library Services (IMLS), with matching funds from the University of Utah.</p>

<div class="divider-full">&nbsp;</div>
<h3>References</h3>

<p><a name="1">[1]</a> Bankhead, H (2009). "Historic Locations with Google Maps using XML from CONTENTdm," presentation at the Western CONTENTdm Users Group Meeting, University of Nevada-Reno, Reno, NV, June 5-6, 2009. <a href="http://www.contentdm.org/USC/usermeetings/Bankhead.pdf">http://www.contentdm.org/USC/usermeetings/Bankhead.pdf</a>.</p>

<p><a name="2">[2]</a> McIntyre, S (2009). "Utah Populated Places, with Links to MWDL Resources," Google map created October 16, 2009. Available 3 June 2011. <a href="https://tinyurl.com/yfa3dp5">http://tinyurl.com/yfa3dp5</a>.</p>

<p><a name="3">[3]</a> Arlitsch, K, et al (2008). "D-Lib Featured Collection November/December 2008: Western Soundscape Archive." <a href="https://dx.doi.org/10.1045/november2008-featured.collection">http://dx.doi.org/10.1045/november2008-featured.collection</a>.</p>

<p><a name="4">[4]</a> Google Geocoding API documentation. Retrieved March 2, 2011 from <a href="https://code.google.com/apis/maps/documentation/geocoding/">http://code.google.com/apis/maps/documentation/geocoding/</a>.</p>

<p><a name="5">[5]</a> Geocoding Addresses with PHP/MySQL. Retrieved March 2, 2011 from  <a href="https://code.google.com/apis/maps/articles/phpsqlgeocode.html">http://code.google.com/apis/maps/articles/phpsqlgeocode.html</a>.</p>

<p><a name="6">[6]</a> Columns used by Excel to KML. <a href="http://www.earthpoint.us/ExcelToKml.aspx">http://www.earthpoint.us/ExcelToKml.aspx</a>.</p>

<p><a name="7">[7]</a> Cox, S, et al (2006). "DCMI Point Encoding Scheme: a point location in space, and methods for encoding this in a text string." <a href="http://dublincore.org/documents/dcmi-point/">http://dublincore.org/documents/dcmi-point/</a>.</p>

<p><a name="8">[8]</a> KML standard. <a href="http://www.opengeospatial.org/standards/kml/">http://www.opengeospatial.org/standards/kml/</a>.</p>

<p><a name="9">[9]</a> KML Support. <a href="https://code.google.com/apis/kml/documentation/mapsSupport.html">http://code.google.com/apis/kml/documentation/mapsSupport.html</a>.</p>

<p><a name="10">[10]</a> Google Earth Icons. <a href="http://www.earthpoint.us/ExcelToKml.aspx#GoogleEarthIcons">http://www.earthpoint.us/ExcelToKml.aspx#GoogleEarthIcons</a>.</p>

<p><a name="11">[11]</a> Concatenate Function, <a href="http://office.microsoft.com/en-us/excel-help/concatenate-function-HP010342288.aspx?CTT=1">http://office.microsoft.com/en-us/excel-help/concatenate-function-HP010342288.aspx?CTT=1</a>.</p>

<p><a name="12">[12]</a> Excel To KML &#151; Display Excel files on Google Earth. <a href="http://www.earthpoint.us/ExcelToKml.aspx">http://www.earthpoint.us/ExcelToKml.aspx</a>.</p>


<div class="divider-full"><a name="appendix">&nbsp;</a></div>
<h3>Appendix</h3>

<p>Item 1: Coordinate Ranking System</p>

<p class="indentNarrow">1 = Very localized, such as a specific address within a city or a specific landmark (e.g., Temple Square, Delicate Arch, etc.)<br />

2 = Locality, such as a town, city, or smallish region<br />

3 = Larger region but within one county (or in the case of Yellowstone and Alaskan regions, no county)<br />

 4 = County<br />

5 = Multi-county regions (e.g., National Forests, mountain ranges like the Cascades, etc.)<br />

6 = States, Provinces<br />

7 = Countries
</p>

<p>Item 2: A general outline of the process in a CONTENTdm collection</p>

<p class="indentNarrow">
1) Stop updates to collection, make it read only<br />  

2) Copy the desc.all file so conversion script can access it<br />  

3) Run conversion script<br />                                                      

4) Replace the desc.all file in the collection <br />                

5) Run the makeoffset script<br />                                            

6) Run the full collection index<br />                                          

7) Remove read-only status from collection<br />                        

8) Extract the collection metadata<br />  

9) Examine coordinates for accuracy<br />                            

10) Build Google map with new coordinates</p>

<p>Item 3: Instructions for Converting CONTENTdm Exported Metadata to a KML file</p>

<ol>
<li class="first">In CONTENTdm</li>

<li class="second" value="1">Export collection metadata as a tab-delimited txt file</li>

<li class="first" value="2">Open text file in Excel and save as a workbook</li>

<li class="first">Retain columns:</li>
<li class="second"  value="1">Title</li> 
<li class="second">Description</li> 
<li class="second">Place name</li>
<li class="second">Latitude</li>
<li class="second">Longitude</li>
<li class="second">Reference URL</li>
<li class="second">CONTENTdm item number</li>
<li class="second">Any additional metadata fields you want included in the map</li>

<li class="first" value="4">Edit column labels:</li>
<li class="second" value="1">Title</li>
<li class="fourth"  value="1">Change to <b>Name</b></li>
<li class="second" value="2">Description</li>
<li class="fourth"  value="1">Change to <b>CDM Description</b></li>

<li class="first" value="5">Edit column format:</li>
<li class="second" value="1">Latitude</li>
<li class="fourth"  value="1">Highlight, click right mouse button</li>
<li class="fourth"  value="2">Format cells</li>
<li class="fourth"  value="3">Number tab</li>
<li class="sixth"  value="1">Number</li>
<li class="sixth"  value="2">Decimal spaces = 6</li>
<li class="second" value="2">Longitude</li>
<li class="fourth"  value="1">Highlight, click right mouse button</li>
<li class="fourth"  value="2">Format cells</li>
<li class="fourth"  value="3">Number tab</li>
<li class="sixth"  value="1">Number</li>
<li class="sixth"  value="2">Decimal spaces = 6</li>

<li class="first" value="6">Insert columns:</li>
<li class="second"  value="1">Icon</li>
<li class="fourth"  value="1">Should be first column, before Name</li>
<li class="fourth"  value="2">Enter icon number </li>
<li class="sixth"  value="1">See <a href="http://www.earthpoint.us/ExcelToKml.aspx#GoogleEarthIcons">http://www.earthpoint.us/ExcelToKml.aspx#GoogleEarthIcons</a></li>
<li class="fourth"  value="3">copy and paste in column's rows</li>
<li class="second"  value="2">Description</li>
<li class="second"  value="3">Blank space</li>
<li class="fourth"  value="1">Enter a space in first row</li>
<li class="fourth"  value="2">Copy and paste space into remaining rows</li>
<li class="second"  value="4">&lt;a href="</li>
<li class="fourth"  value="1">Copy and paste column heading into remaining rows</li>
<li class="second"  value="5">"&gt; &lt;img style="width:243px" src="</li>
<li class="fourth"  value="1">Copy and paste column heading into remaining rows</li>
<li class="second"  value="6">Use the base URL for your collection; on a system running CONTENTdm it would contain the collection alias for the collection you are working with <a href="http://content.lib.utah.edu/cgi-bin/thumbnail.exe?CISOROOT=/wss&amp;CISOPTR=">http://content.lib.utah.edu/cgi-bin/thumbnail.exe?CISOROOT=/wss&CISOPTR=</a></li>
<li class="fourth"  value="1">NOTE: /wss=collection alias, check CONTENTdm for appropriate collection alias to use</li>
<li class="fourth"  value="2">Copy and paste column heading into column's rows</li>
<li class="second"  value="7">"> &lt;/a&gt; &lt;br&gt;</li>
<li class="fourth"  value="1">Copy and paste column heading into remaining rows</li>

<li class="first" value="7">Insert blank row underneath column heading row</li>
<li class="second"  value="1">For this row only enter the following values:</li>
<li class="fourth"  value="1">Latitude</li>
<li class="sixth"  value="1">Enter 00.00000</li>
<li class="fourth"  value="2">Longitude</li>
<li class="sixth"  value="1">Enter 00.00000</li>
<li class="fourth"  value="3">Description</li>
<li class="sixth"  value="1">Enter =REPT("",256)</li>
<li class="sixth"  value="2">NOTE: This prevents the truncation of information in this column at 255 characters.</li>
<li class="second"  value="2">This row will generate a blue (default) icon in the final map which should be deleted before the map is made publicly accessible.</li>

<li class="first" value="8">Edit row 3 of Description:</li>
<li class="second"  value="1">Add formula</li>
<li class="fourth"  value="1">=CONCATENATE(a3,b3,c3,etc.)</li>
<li class="second"  value="2">Cells listed in ( ) should correspond with the metadata you want included in the map (e.g., CDM description, place name, thumbnail script).</li>
<li class="second"  value="3">Note: Name (i.e., Title) is added by default and does not need to be included in the formula.</li>
<li class="second"  value="4">Include the blank space referenced in Step 6c in the concatenation formula as needed to create spaces between combined columns of information, for example, the place names and the reference URL.</li>  

<li class="first" value="9">Save completed spreadsheet. Open <a href="http://www.earthpoint.us/ExcelToKml.aspx">http://www.earthpoint.us/ExcelToKml.aspx</a>.</li>

<li class="first" value="10">Browse to spreadsheet. Use view on web page to see if there are errors, otherwise use "view in Google Earth".</li>

<li class="first" value="11">When Google Earth opens it loads the spreadsheet, which is now converted to a KML/KMZ.</li> 
<li class="second"  value="1">The blank row (Step 7) will prompt an error message in Google Earth given the 00.00000 latitude and longitude values assigned to it (this entry was necessary to avoid truncation of descriptions). The resulting pinpoint in Google Earth should be deleted.</li> 
<li class="second"  value="2">Go to File menu in Google Earth; select Save and Save Place As; save as a KML or KMZ to your hard drive.</li>

<li class="first" value="12">Two methods for adding KML/KMZ to website:</li>
<li class="second"  value="1">Embed using Google Embed KML gadget</li> 
<li class="second"  value="2">Use Google My Maps account and create new map to import retrieved HTML for embedding</li> 
</ol>

<div class="divider-full">&nbsp;</div>
<h3>About the Authors</h3>

<table border="0"  cellpadding="6" bgcolor="#FFFFFF"> 
<tr>
<td align="center"><img src="neatrour-1.jpg" class="border" alt="Photo of Anna Neatrour" width="100" height="122" /></td>
<td>
<p class="blue"><b>Anna Neatrour </b> works in digital projects at the University of Utah J. Willard Marriott Library and previously served as project manager for the Western Soundscape Archive. She is also the executive director of the Utah Library Association. She received her MLIS from the University of Illinois Urbana-Champaign.</p>
</td>
</tr>
</table>

<div class="divider-full">&nbsp;</div>

<table border="0"  cellpadding="6" bgcolor="#FFFFFF"> 
<tr>
<td align="center"><img src="morrow.jpg" class="border" alt="Photo of Anne Morrow" width="100" height="151" /></td>
<td>
<p class="blue"><b>Anne Morrow </b> is a Digital Initiatives Librarian at the University of Utah J. Willard Marriott Library.  Anne has a background in digital libraries, institutional repositories, metadata and cataloging.  Most recently she has been involved in faculty publishing initiatives and was instrumental in developing the use of QR codes to connect mobile device users with library services and programs. </p>
</td>
</tr>
</table>

<div class="divider-full">&nbsp;</div>

<table border="0"  cellpadding="6" bgcolor="#FFFFFF"> 
<tr>
<td align="center"><img src="rockwell.jpg" class="border" alt="Photo of Ken Rockwell" width="100" height="131" /></td>
<td>
<p class="blue"><b>Ken Rockwell </b> is an Associate Librarian who has worked at the J. Willard Marriott Library since 1989. His expertise is in metadata, including the cataloging of maps and description and subject analysis of digital collections. He has been providing metadata for the Western Soundscape Archive from its birth online and did geospatial quality control for the mapping project described in this article.</p>
</td>
</tr>
</table>


<div class="divider-full">&nbsp;</div>

<table border="0"  cellpadding="6" bgcolor="#FFFFFF"> 
<tr>
<td align="center"><img src="witkowski.jpg" class="border" alt="Photo of Alan Witkowski" width="100" height="136" /></td>
<td>
<p class="blue"><b>Alan Witkowski </b> graduated from the University of Utah in 2006 with a degree in Computer Science. He has been at the J Willard Marriott Library's application programing division for two years.</p>
</td>
</tr>
</table>

<div class="divider-full">&nbsp;</div>

 <!-- Standard Copyright line here  -->

<div class="center">

<p class="footer">Copyright &copy; 2011 Anna Neatrour, Anne Morrow, Ken Rockwell, and Alan Witkowski
</p>  
  </div>
</td>
 </tr>
</table>

<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td height="1" bgcolor="#2b538e"><img src="../../../img2/transparent.gif" alt="transparent image" width="100" height="2" /></td>
  </tr>
</table>

</td></tr></table>
</td></tr></table>
</form>

<script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>